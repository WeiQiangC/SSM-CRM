<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Dao.Setting.UserDao">

	<select id="getTotalDeptType" resultType="Domain.setting.DeptType">
		select * from tbl_dept_type
	</select>

	<select id="getUserTotal" resultType="int">
		select count(*) from tbl_user
	</select>

	<select id="getUserListByLimt" resultType="Domain.setting.User">
		select 
		user.id                       ,
        user.loginAct                 ,
        user.name                     ,
        user.loginPwd                 ,
        user.email                    ,
        user.expireTime               ,
        user.lockState                ,
        dept.depeName as deptno         ,
        user.allowIps                 ,
        user.createTime               ,
        user.createBy                 ,
        user.editTime                 ,
        user.editBy
		from tbl_user user join tbl_dept_type dept on user.deptno = dept.deptId
		order by user.createTime desc limit #{start},#{number}
	</select>

	<select id="getTotal" resultType="Domain.setting.Dept">
		select * from tbl_dept_value
	</select>

	<delete id="delete">
		delete from tbl_dept_value
		where id in
		<foreach collection="array" open="(" close=")" item="id" separator=",">
			#{id}
		</foreach> 
	</delete>
	
	<update id="editUpdate">
		update tbl_dept_value set deptId=#{deptId},deptName=#{deptName},deptBoss=#{deptBoss},bossTelephone=#{bossTelephone},description=#{description}
		where id = #{id}
	</update>
	
	
	<select id="getEditDept" resultType="Domain.setting.Dept">
		select * from tbl_dept_value where id = #{id}
	</select>
	
	
	<insert id="createDept">
		insert into tbl_dept_value
		(id,deptId,deptName,deptBoss,bossTelephone,description,createTime)
		values
		(#{id},#{deptId},#{deptName},#{deptBoss},#{bossTelephone},#{description},#{createTime})
	</insert>

	<select id="login" resultType="Domain.setting.User">
		select * from tbl_user where loginAct = #{loginAct} and loginPwd = #{loginPwd}
	</select>
	
	<update id="updatePwd">
		update tbl_user set loginPwd = #{newPwd} where id = #{id}
	</update>
	
	<select id="getUserList" resultType="Domain.setting.User">
		select * from tbl_user
	</select>
	
	<select id="pageList" resultType="Domain.setting.Dept">
		select * from tbl_dept_value order by createTime desc  limit #{start},#{number} 
	</select>
</mapper>